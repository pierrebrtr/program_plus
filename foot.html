<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Pierre Bertier">
    <meta name="generator" content="Pierre 0.1">
    <title>Program+ | Football</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/jumbotron/">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootstrap core CSS -->
<link href="./assets/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="./assets/dist/css/main.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" rel="stylesheet">    
  </head>
  <body>
    
<main>
  <div class="container py-4">
    <header class="pb-3 mb-4 border-bottom">
      <div href="/" class="  text-dark text-decoration-none">
        <span   class="fs-4 float-left"><div><a class="header" href="index.html"><b>Program+</b></a> Football</span>
        <span class="fs-4 float-right" ><button type="button" class="btn btn-primary refreshBtn" style="left:81%; position: absolute;"><i class="fa-solid fa-arrows-rotate"></i></button></span>
        
      </div>
    </header>

    <div class="p-2 mb-4 bg-light rounded-3 text-center scrollMenu">
     <a href="#tableLigue1">Ligue 1</a>><a href="#tableEPL">EPL</a>><a href="#tableEuropaLeague">Europa League</a>><a href="#tableChampionsLeague">Champions League</a>
    </div>
    
    <div class="p-5 mb-4 bg-light rounded-3 ligue1" id="tableLigue1">
      <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold">Ligue 1</h1>
        <table class="table">
          <thead>
            <tr>
              <th></th>
              <th scope="col">Date</th>
              <th scope="col">Journée</th>
              <th scope="col">Heure</th>
              <th scope="col">Match</th>
              <th scope="col">Competition</th>
              <th scope="col">Diffuseur</th>
              
            </tr>
          </thead>
          <tbody>
            <!-- template --> 
           
            <tr style="display: none" data-type="templateLigue1">
              <td><button type="button" class="btn btn-primary copyBtnFootballLigue1"><i class="far fa-copy"></i></button></td>
              <th scope="row" class="MatchDate">Vendredi 15 Octobre</th>
              <td  class="MatchDayCompetition"></td>
              <td  class="MatchHour">15h00</td>
              <td  class="MatchTeams">Clermont - Laval</td>
              <td  class="MatchCompetition">Ligue 1</td>
              <td class="MatchDiffusor"><img style="width: 44px;" class="imgDiffusor" /></td>
              <td style="display: none" class="MatchDiffusorName"></td>
              <td style="display: none" class="MatchUrlDiffusion"></td>
             
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="p-5 mb-4 bg-light rounded-3 epl" id="tableEPL">
      <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold">EPL</h1>
        <table class="table">
          <thead>
            <tr>
              <th></th>
              <th scope="col">Date</th>
              <th scope="col">Journée</th>
              <th scope="col">Heure</th>
              <th scope="col">Match</th>
              <th scope="col">Competition</th>
              <th scope="col">Diffuseur</th>
              
            </tr>
          </thead>
          <tbody>
            <!-- template --> 
           
            <tr style="display: none" data-type="templateEpl">
              <td><button type="button" class="btn btn-primary copyBtnFootballEPL"><i class="far fa-copy"></i></button></td>
              <th scope="row" class="MatchDate">Vendredi 15 Octobre</th>
              <td  class="MatchDayCompetition"></td>
              <td  class="MatchHour">15h00</td>
              <td  class="MatchTeams">Clermont - Laval</td>
              <td  class="MatchCompetition">Premier League</td>
              <td class="MatchDiffusor"><img style="width: 44px;" class="imgDiffusor" /></td>
              <td style="display: none" class="MatchDiffusorName"></td>
              <td style="display: none" class="MatchUrlDiffusion"></td>
             
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    
    <div class="p-5 mb-4 bg-light rounded-3 eL" id="tableEuropaLeague">
      <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold">Europa League</h1>
        <table class="table">
          <thead>
            <tr>
              <th></th>
              <th scope="col">Date</th>
              <th scope="col">Journée</th>
              <th scope="col">Heure</th>
              <th scope="col">Match</th>
              <th scope="col">Competition</th>
              <th scope="col">Diffuseur</th>
              
            </tr>
          </thead>
          <tbody>
            <!-- template --> 
           
            <tr style="display: none" data-type="templateEL">
              <td><button type="button" class="btn btn-primary copyBtnFootballEL"><i class="far fa-copy"></i></button></td>
              <th scope="row" class="MatchDate">Vendredi 15 Octobre</th>
              <td  class="MatchDayCompetition"></td>
              <td  class="MatchHour">15h00</td>
              <td  class="MatchTeams">Clermont - Laval</td>
              <td  class="MatchCompetition">Europa League</td>
              <td class="MatchDiffusor"><img style="width: 44px;" class="imgDiffusor" /></td>
              <td style="display: none" class="MatchDiffusorName"></td>
              <td style="display: none" class="MatchUrlDiffusion"></td>
             
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="p-5 mb-4 bg-light rounded-3 cL" id="tableChampionsLeague">
      <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold">Champions League</h1>
        <table class="table">
          <thead>
            <tr>
              <th></th>
              <th scope="col">Date</th>
              <th scope="col">Journée</th>
              <th scope="col">Heure</th>
              <th scope="col">Match</th>
              <th scope="col">Competition</th>
              <th scope="col">Diffuseur</th>
              
            </tr>
          </thead>
          <tbody>
            <!-- template --> 
           
            <tr style="display: none" data-type="templateCL">
              <td><button type="button" class="btn btn-primary copyBtnFootballCL"><i class="far fa-copy"></i></button></td>
              <th scope="row" class="MatchDate">Vendredi 15 Octobre</th>
              <td  class="MatchDayCompetition"></td>
              <td  class="MatchHour">15h00</td>
              <td  class="MatchTeams">Clermont - Laval</td>
              <td  class="MatchCompetition">Champions League</td>
              <td class="MatchDiffusor"><img style="width: 44px;" class="imgDiffusor" /></td>
              <td style="display: none" class="MatchDiffusorName"></td>
              <td style="display: none" class="MatchUrlDiffusion"></td>
             
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <footer class="pt-3 mt-4 text-muted border-top">
      &copy; 2021 - Pierre Bertier
    </footer>
  </div>
</main>


    <script>

      var today = new Date();

      function formatDate(date, format) {
          const map = {
              mm: date.getMonth() + 1,
              dd: date.getDate(),
              yy: date.getFullYear().toString().slice(-2),
              yyyy: date.getFullYear()
          }

          return format.replace(/mm|dd|yy|yyy/gi, matched => map[matched])
      }

      function addUpHour(time, nb) {    
        let timeInt = parseInt(time);
        let minutes = time.substring(3,5);
        timeInt += nb;
        return `${timeInt}:${minutes}`;
      } 

      function initMonth(date) {
        value = date.split("/");
        var d = new Date(value[2], parseInt(value[1], 10)-1, value[0]);
        d.setDate(1)
        console.log("Formatted date" + d)
        return formatDate(d, 'dd/mm/yy')
      }

      $(document).on('click','.refreshBtn', function(event) {
        window.location.href = window.location.pathname + window.location.search + window.location.hash;
      });

            function copyToClipboard(textToCopy) {
          // navigator clipboard api needs a secure context (https)
          if (navigator.clipboard && window.isSecureContext) {
              // navigator clipboard api method'
              return navigator.clipboard.writeText(textToCopy);
          } else {
              // text area method
              let textArea = document.createElement("textarea");
              textArea.value = textToCopy;
              // make the textarea out of viewport
              textArea.style.position = "fixed";
              textArea.style.left = "-999999px";
              textArea.style.top = "-999999px";
              document.body.appendChild(textArea);
              textArea.focus();
              textArea.select();
              return new Promise((res, rej) => {
                  // here the magic happens
                  document.execCommand('copy') ? res() : rej();
                  textArea.remove();
              });
          }
      }

      $(document).on('click','.copyBtnFootballLigue1', function(event) {

      var textToCopy = initMonth($(this).closest('tr').children(".MatchDate").text()) + "	" + $(this).closest('tr').children(".MatchDate").text() + "	" + "1" + "	" + "Football" + "	" + "Ligue 1" + "	" + $(this).closest('tr').children(".MatchDayCompetition").text() + "	" + $(this).closest('tr').children(".MatchTeams").text() + "	" + $(this).closest('tr').children(".MatchHour").text() + "	" + addUpHour($(this).closest('tr').children(".MatchHour").text(), 2) + "	" + $(this).closest('tr').children(".MatchDiffusorName").text() + "	" + formatDate(today, 'dd/mm/yy') + "	" + $(this).closest('tr').children(".MatchUrlDiffusion").text();
        copyToClipboard(textToCopy)
    .then(() => console.log('text copied !'))
    .catch(() => console.log('error'));
      });

     $(document).on('click','.copyBtnFootballEPL', function(event) {

        var textToCopy = initMonth($(this).closest('tr').children(".MatchDate").text()) + "	" + $(this).closest('tr').children(".MatchDate").text() + "	" + "1" + "	" + "Football" + "	" + "Premier League" + "	" + $(this).closest('tr').children(".MatchDayCompetition").text() + "	" + $(this).closest('tr').children(".MatchTeams").text() + "	" + $(this).closest('tr').children(".MatchHour").text() + "	" + addUpHour($(this).closest('tr').children(".MatchHour").text(), 2) + "	" + $(this).closest('tr').children(".MatchDiffusorName").text() + "	" + formatDate(today, 'dd/mm/yy') + "	" + $(this).closest('tr').children(".MatchUrlDiffusion").text();
        copyToClipboard(textToCopy)
    .then(() => console.log('text copied !'))
    .catch(() => console.log('error'));
      });

      $(document).on('click','.copyBtnFootballEL', function(event) {

      var textToCopy = initMonth($(this).closest('tr').children(".MatchDate").text()) + "	" + $(this).closest('tr').children(".MatchDate").text() + "	" + "1" + "	" + "Football" + "	" + "Europa League" + "	" + $(this).closest('tr').children(".MatchDayCompetition").text() + "	" + $(this).closest('tr').children(".MatchTeams").text() + "	" + $(this).closest('tr').children(".MatchHour").text() + "	" + addUpHour($(this).closest('tr').children(".MatchHour").text(), 2) + "	" + $(this).closest('tr').children(".MatchDiffusorName").text() + "	" + formatDate(today, 'dd/mm/yy') + "	" + $(this).closest('tr').children(".MatchUrlDiffusion").text();
      console.log(textToCopy)
      copyToClipboard(textToCopy)
    .then(() => console.log('text copied !'))
    .catch(() => console.log('error'));
      });

      $(document).on('click','.copyBtnFootballCL', function(event) {

      var textToCopy = initMonth($(this).closest('tr').children(".MatchDate").text()) + "	" + $(this).closest('tr').children(".MatchDate").text() + "	" + "1" + "	" + "Football" + "	" + "Champions League" + "	" + $(this).closest('tr').children(".MatchDayCompetition").text() + "	" + $(this).closest('tr').children(".MatchTeams").text() + "	" + $(this).closest('tr').children(".MatchHour").text() + "	" + addUpHour($(this).closest('tr').children(".MatchHour").text(), 2) + "	" + $(this).closest('tr').children(".MatchDiffusorName").text() + "	" + formatDate(today, 'dd/mm/yy') + "	" + $(this).closest('tr').children(".MatchUrlDiffusion").text();
      copyToClipboard(textToCopy)
    .then(() => console.log('text copied !'))
    .catch(() => console.log('error'));
      });

      var tbodyRef = document.getElementById('tableEPL').getElementsByTagName('tbody')[0];
      var tbodyRefLigue1 = document.getElementById('tableLigue1').getElementsByTagName('tbody')[0];
      var tbodyRefEL = document.getElementById('tableEuropaLeague').getElementsByTagName('tbody')[0];
      var tbodyRefCL = document.getElementById('tableChampionsLeague').getElementsByTagName('tbody')[0];

      $(document).ready(function() {
        $.ajax({
          url: "http://193.168.146.76:8000/football",
          type: "GET",
          success: function(result) {
            for (const element of result["EPL"]) {
              var docFrag = document.createDocumentFragment();
              var tempNode = document.querySelector("tr[data-type='templateEpl']").cloneNode(true); //true for deep clone
              tempNode.querySelector("td.MatchHour").textContent = element["hour"];
              tempNode.querySelector("th.MatchDate").textContent = element["date"];
              tempNode.querySelector("td.MatchTeams").textContent = element["teams"];
              tempNode.querySelector("td.MatchDiffusorName").textContent = element["diffusorName"];
              tempNode.querySelector("td.MatchUrlDiffusion").textContent = element["urlPage"];
              tempNode.querySelector("td.MatchDayCompetition").textContent = element["journee"];
              tempNode.querySelector("td.MatchDiffusor").querySelector("img.imgDiffusor").src = element["diffusor"];
              tempNode.style.display = "table-row";
              tbodyRef.appendChild(tempNode);
            }


            for (const element of result["Ligue 1"]) {
              var docFrag = document.createDocumentFragment();
              var tempNode = document.querySelector("tr[data-type='templateLigue1']").cloneNode(true); //true for deep clone
              tempNode.querySelector("td.MatchHour").textContent = element["hour"];
              tempNode.querySelector("th.MatchDate").textContent = element["date"];
              tempNode.querySelector("td.MatchTeams").textContent = element["teams"];
              tempNode.querySelector("td.MatchDiffusorName").textContent = element["diffusorName"];
              tempNode.querySelector("td.MatchUrlDiffusion").textContent = element["urlPage"];
              tempNode.querySelector("td.MatchDayCompetition").textContent = element["journee"];
              tempNode.querySelector("td.MatchDiffusor").querySelector("img.imgDiffusor").src = element["diffusor"];
              tempNode.style.display = "table-row";
              tbodyRefLigue1.appendChild(tempNode);
            }

            for (const element of result["EuropaLeague"]) {
              var docFrag = document.createDocumentFragment();
              var tempNode = document.querySelector("tr[data-type='templateEL']").cloneNode(true); //true for deep clone
              tempNode.querySelector("td.MatchHour").textContent = element["hour"];
              tempNode.querySelector("th.MatchDate").textContent = element["date"];
              tempNode.querySelector("td.MatchTeams").textContent = element["teams"];
              tempNode.querySelector("td.MatchDiffusorName").textContent = element["diffusorName"];
              tempNode.querySelector("td.MatchUrlDiffusion").textContent = element["urlPage"];
              tempNode.querySelector("td.MatchDayCompetition").textContent = element["journee"];
              tempNode.querySelector("td.MatchDiffusor").querySelector("img.imgDiffusor").src = element["diffusor"];
              tempNode.style.display = "table-row";
              tbodyRefEL.appendChild(tempNode);
            }

            for (const element of result["ChampionsLeague"]) {
              var docFrag = document.createDocumentFragment();
              var tempNode = document.querySelector("tr[data-type='templateCL']").cloneNode(true); //true for deep clone
              tempNode.querySelector("td.MatchHour").textContent = element["hour"];
              tempNode.querySelector("th.MatchDate").textContent = element["date"];
              tempNode.querySelector("td.MatchTeams").textContent = element["teams"];
              tempNode.querySelector("td.MatchDiffusorName").textContent = element["diffusorName"];
              tempNode.querySelector("td.MatchUrlDiffusion").textContent = element["urlPage"];
              tempNode.querySelector("td.MatchDayCompetition").textContent = element["journee"];
              tempNode.querySelector("td.MatchDiffusor").querySelector("img.imgDiffusor").src = element["diffusor"];
              tempNode.style.display = "table-row";
              tbodyRefCL.appendChild(tempNode);
            }
          },
          error: function(error) {
            console.log(error);
          }
        });
      });

      $('.scrollMenu').find('a').click(function(){
        var $href = $(this).attr('href');
        var $anchor = $($href).offset();
        window.scrollTo($anchor.left,$anchor.top);
        return false;
      });
    </script>
  </body>
</html>
